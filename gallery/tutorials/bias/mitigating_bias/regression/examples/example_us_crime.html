

<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bias Measuring and Mitigation in Regression Tasks &#8212; holistic  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/css/custom_style.css?v=ac75cb35" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/tutorials/bias/mitigating_bias/regression/examples/example_us_crime';</script>
    <link rel="icon" href="../../../../../../_static/holistic_ai.png"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../../_static/hai_logo.svg" class="logo__image only-light" alt="holistic  documentation - Home"/>
    <img src="https://assets-global.website-files.com/6305e5d42c283515c3e71b8c/63d771efd50a073bd66193f0_Holistic-AI-Logo-Horizontal-Dark.svg" class="logo__image only-dark pst-js-only" alt="holistic  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><strong>Bias Measuring and Mitigation in Regression Tasks</strong></span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Bias-Measuring-and-Mitigation-in-Regression-Tasks">
<h1><strong>Bias Measuring and Mitigation in Regression Tasks</strong><a class="headerlink" href="#Bias-Measuring-and-Mitigation-in-Regression-Tasks" title="Link to this heading">#</a></h1>
<p>Bias in machine learning models can occur when predictions systematically deviate from the true values for certain subgroups within the dataset. This bias can arise from various sources such as unbalanced group representation in the training data, inappropriate feature selection, or flawed model specifications. This tutorial focuses on addressing bias in regression tasks.</p>
<section id="Measuring-Bias-in-Regression-Tasks">
<h2>Measuring Bias in Regression Tasks<a class="headerlink" href="#Measuring-Bias-in-Regression-Tasks" title="Link to this heading">#</a></h2>
<p>To measure bias, we use fairness metrics such as demographic parity, equalized odds, or equal opportunity. These metrics quantify differences in model performance across subgroups defined by sensitive attributes like gender or race.</p>
</section>
<section id="Mitigating-Bias">
<h2>Mitigating Bias<a class="headerlink" href="#Mitigating-Bias" title="Link to this heading">#</a></h2>
<p>Upon detecting bias, we can mitigate it using techniques categorized into three groups:</p>
<ol class="arabic simple">
<li><p><strong>Pre-processing methods:</strong> Adjust the training data to remove bias.</p></li>
<li><p><strong>In-processing methods:</strong> Modify the learning algorithm to reduce bias during training.</p></li>
<li><p><strong>Post-processing methods:</strong> Adjust model predictions to eliminate bias.</p></li>
</ol>
<p>This tutorial will demonstrate tools for measuring and mitigating bias in regression models through the following steps:</p>
<ol class="arabic simple">
<li><p>Data loading and package installation</p></li>
<li><p>Dataset preprocessing</p></li>
<li><p>Data analysis</p></li>
<li><p>Model training</p></li>
<li><p>Bias measurement</p></li>
<li><p>Bias mitigation</p>
<ul class="simple">
<li><p>Pre-processing: Correlation Remover</p></li>
<li><p>In-processing: Exponentiated Gradient</p></li>
<li><p>Post-processing: Wasserstein Barycenters</p></li>
</ul>
</li>
<li><p>Results comparison</p></li>
</ol>
<section id="1.-Data-Loading-and-Packages-Installation">
<h3><strong>1. Data Loading and Packages Installation</strong><a class="headerlink" href="#1.-Data-Loading-and-Packages-Installation" title="Link to this heading">#</a></h3>
<p>First, install the required packages. If you don’t have the <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> package, install it using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>!pip<span class="w"> </span>install<span class="w"> </span>holisticai<span class="o">[</span>all<span class="o">]</span>
</pre></div>
</div>
<p>We will then import the necessary libraries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</pre></div>
</div>
</div>
<p>To ensure reproducibility and ignore warnings for cleaner outputs:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Dataset-preprocessing">
<h3><strong>2. Dataset preprocessing</strong><a class="headerlink" href="#2.-Dataset-preprocessing" title="Link to this heading">#</a></h3>
<p>We will use the “Communities and Crime” dataset, which includes socio-economic and law enforcement data for 1994 U.S. communities. It contains demographic variables like population size, race, and education level, alongside law enforcement variables. The goal is to predict the crime rate per capita.</p>
<p>Source: <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/communities+and+crime">UCI ML repository</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
</pre></div>
</div>
</div>
<p>Using the holisticai package, we load and preprocess the dataset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;us_crime&#39;</span><span class="p">,</span> <span class="n">protected_attribute</span><span class="o">=</span><span class="s2">&quot;race&quot;</span><span class="p">)</span>
<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: #f2f8fd !important; /* Container background: light blue */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: #a0c4ff9a !important; /* Header background: darker blue */
}

.generic-object-header.blue:hover {
    background-color: #8bb1c0 !important; /* Darker shade on hover over the header */
}

.attribute-list.blue:hover {
    background-color: #b2dfdb !important; /* Attribute background on hover: darker blue */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 1px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
}

.generic-object-container:hover {
    box-shadow: 0px 4px 10px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

    </style>
    <div style="display: flex;">
    <div class="generic-object-container blue first-level">
        <div class="generic-object-content">
            <div class="generic-object-header blue" onclick="toggleCollapse(this)">
                <button class="toggle-button blue">[-]</button> [Dataset]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list blue"><strong>Instances</strong>: 1993</div><div class="attribute-list blue"><strong>Features</strong>: X , y , p_attrs , group_a , group_b</div><div class="attribute-list blue"><strong>Metadata</strong>: race: {'group_a': 'racePctWhite>0.5', 'group_b': 'racePctWhite<=0.5'}</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
<p>Check for any missing values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
state                  0
fold                   0
population             0
householdsize          0
racepctblack           0
                      ..
PctSameState85         0
LandArea               0
PopDens                0
PctUsePubTrans         0
LemasPctOfficDrugUn    0
Length: 101, dtype: int64
</pre></div></div>
</div>
</section>
<section id="3.-Data-analysis">
<h3><strong>3. Data analysis</strong><a class="headerlink" href="#3.-Data-analysis" title="Link to this heading">#</a></h3>
<p>Next, analyze the distribution of the protected groups using a pie chart.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.bias.plots</span> <span class="kn">import</span> <span class="n">group_pie_plot</span>

<span class="n">group_pie_plot</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/gallery_tutorials_bias_mitigating_bias_regression_examples_example_us_crime_12_1.png" src="../../../../../../_images/gallery_tutorials_bias_mitigating_bias_regression_examples_example_us_crime_12_1.png" />
</div>
</div>
<p>The chart shows a high proportion of white individuals (labelled as True). We also examine the features most correlated with the target variable:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.datasets.plots</span> <span class="kn">import</span> <span class="n">correlation_matrix_plot</span>

<span class="n">correlation_matrix_plot</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">target_feature</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;Correlation matrix&#39;}&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/gallery_tutorials_bias_mitigating_bias_regression_examples_example_us_crime_14_1.png" src="../../../../../../_images/gallery_tutorials_bias_mitigating_bias_regression_examples_example_us_crime_14_1.png" />
</div>
</div>
<p>Split the data into training and testing sets:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Model-training">
<h3><strong>4. Model training</strong><a class="headerlink" href="#4.-Model-training" title="Link to this heading">#</a></h3>
<p>Train a linear regression model, ensuring the protected attributes are excluded from the training process:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">LR</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">baseline_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMS error: </span><span class="si">{</span><span class="n">baseline_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RMS error: 0.1416613079551982
</pre></div></div>
</div>
</section>
<section id="5.-Measuring-Bias">
<h3><strong>5. Measuring Bias</strong><a class="headerlink" href="#5.-Measuring-Bias" title="Link to this heading">#</a></h3>
<p>To evaluate the fairness of the model, we use the predictions alongside the previously defined protected groups. The <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> package provides a module specifically designed for calculating various metrics that assess the fairness of algorithmic decisions. In this tutorial, we will utilize the <code class="docutils literal notranslate"><span class="pre">regression_bias_metrics</span></code> function to measure bias in our regression model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.bias.metrics</span> <span class="kn">import</span> <span class="n">regression_bias_metrics</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">regression_bias_metrics</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span>
    <span class="n">y_pred</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
    <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">y_baseline</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_baseline</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_baseline</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Disparate Impact Q90</th>
      <td>0.019666</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q80</th>
      <td>0.117994</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q50</th>
      <td>0.412979</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Statistical Parity Q50</th>
      <td>-0.705605</td>
      <td>0</td>
    </tr>
    <tr>
      <th>No Disparate Impact Level</th>
      <td>0.056745</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Average Score Difference</th>
      <td>-0.373790</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Score Ratio</th>
      <td>0.308392</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Z Score Difference</th>
      <td>-2.750267</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Max Statistical Parity</th>
      <td>0.767257</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Statistical Parity AUC</th>
      <td>0.452860</td>
      <td>0</td>
    </tr>
    <tr>
      <th>RMSE Ratio</th>
      <td>0.614069</td>
      <td>1</td>
    </tr>
    <tr>
      <th>RMSE Ratio Q80</th>
      <td>0.966421</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio</th>
      <td>0.486594</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio Q80</th>
      <td>0.937572</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Correlation Difference</th>
      <td>0.002428</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Understanding the Metrics</p>
<ol class="arabic simple">
<li><p><strong>Disparate Impact Q:</strong> Ratio of success rates between protected groups. Values &lt; 1 favor <code class="docutils literal notranslate"><span class="pre">group_a</span></code>, values &gt; 1 favor <code class="docutils literal notranslate"><span class="pre">group_b</span></code>. Acceptable range: (0.8, 1.2).</p></li>
<li><p><strong>Statistical Parity:</strong> Difference in success rates between groups. Values &lt; 0 favor <code class="docutils literal notranslate"><span class="pre">group_a</span></code>, values &gt; 0 favor <code class="docutils literal notranslate"><span class="pre">group_b</span></code>.</p></li>
<li><p><strong>Average Score Difference:</strong> Difference in average scores. Negative values indicate bias against <code class="docutils literal notranslate"><span class="pre">group_a</span></code>, positive against <code class="docutils literal notranslate"><span class="pre">group_b</span></code>.</p></li>
<li><p><strong>Z Score Difference:</strong> Spread in Z-scores, normalized version of Disparate Impact.</p></li>
<li><p><strong>Max Statistical Parity:</strong> Maximum absolute statistical parity over all thresholds. Values &lt; 0.1 (absolute) are acceptable.</p></li>
<li><p><strong>RMSE Ratio:</strong> RMSE for protected groups. Lower values favor <code class="docutils literal notranslate"><span class="pre">group_a</span></code>, higher favor <code class="docutils literal notranslate"><span class="pre">group_b</span></code>.</p></li>
<li><p><strong>MAE Ratio:</strong> Similar to RMSE Ratio.</p></li>
<li><p><strong>Correlation Difference:</strong> Difference in prediction-target correlation between groups. Positive values favor <code class="docutils literal notranslate"><span class="pre">group_a</span></code>, negative favor <code class="docutils literal notranslate"><span class="pre">group_b</span></code>.</p></li>
</ol>
</section>
<section id="6.-Bias-Mitigation">
<h3><strong>6. Bias Mitigation</strong><a class="headerlink" href="#6.-Bias-Mitigation" title="Link to this heading">#</a></h3>
<p>After identifying that the model metrics deviate significantly from the desired values, we need to apply strategies to mitigate the bias present in the model.</p>
<p>There are various bias mitigation strategies categorized into three types: <em>Pre-processing</em>, <em>In-processing</em>, and <em>Post-processing</em> methods. The <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> library offers a range of algorithms for bias mitigation across these categories. A notable feature is their compatibility with the <code class="docutils literal notranslate"><span class="pre">Scikit-learn</span></code> package, ensuring ease of use for those familiar with Scikit-learn. Implementation can follow traditional methods or be integrated into a pipeline, as we will demonstrate.</p>
</section>
</section>
<section id="Pre-processing:-Correlation-Remover">
<h2><strong>Pre-processing: Correlation Remover</strong><a class="headerlink" href="#Pre-processing:-Correlation-Remover" title="Link to this heading">#</a></h2>
<p>First, we will implement the “Correlation Remover” method, a pre-processing algorithm that modifies the original dataset. This technique removes all correlations with sensitive attributes by applying a linear transformation to the non-sensitive feature columns.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">CorrelationRemover</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">corr</span> <span class="o">=</span> <span class="n">CorrelationRemover</span><span class="p">()</span>
<span class="n">processed_data</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">processed_data</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">processed_data</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">processed_data</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">regression_bias_metrics</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span>
    <span class="n">y_pred</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
    <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">df_correm</span> <span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_correm</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Disparate Impact Q90</th>
      <td>0.412979</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q80</th>
      <td>0.530973</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q50</th>
      <td>0.806293</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Statistical Parity Q50</th>
      <td>-0.156342</td>
      <td>0</td>
    </tr>
    <tr>
      <th>No Disparate Impact Level</th>
      <td>0.202414</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Average Score Difference</th>
      <td>-0.032719</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Score Ratio</th>
      <td>0.871787</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Z Score Difference</th>
      <td>-0.239919</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Max Statistical Parity</th>
      <td>0.216814</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Statistical Parity AUC</th>
      <td>0.107243</td>
      <td>0</td>
    </tr>
    <tr>
      <th>RMSE Ratio</th>
      <td>0.374976</td>
      <td>1</td>
    </tr>
    <tr>
      <th>RMSE Ratio Q80</th>
      <td>0.483447</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio</th>
      <td>0.332584</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio Q80</th>
      <td>0.434959</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Correlation Difference</th>
      <td>0.002576</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Evaluate RMSE:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correm_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMS error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correm_rmse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RMS error: 0.1876979543987722
</pre></div></div>
</div>
</section>
<section id="In-processing:-Exponentiated-Gradient">
<h2><strong>In-processing: Exponentiated Gradient</strong><a class="headerlink" href="#In-processing:-Exponentiated-Gradient" title="Link to this heading">#</a></h2>
<p>Next, we will implement the “Exponentiated Gradient Reduction” method, an in-processing technique. This approach reduces fair classification to a series of cost-sensitive classification problems, resulting in a randomized classifier with the lowest empirical error while adhering to fair classification constraints.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">ExponentiatedGradientReduction</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">inprocessing_model</span> <span class="o">=</span> <span class="n">ExponentiatedGradientReduction</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="s2">&quot;BoundedGroupLoss&quot;</span><span class="p">,</span>
                                         <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;Square&#39;</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                                         <span class="p">)</span><span class="o">.</span><span class="n">transform_estimator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">inprocessing_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">inprocessing_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">regression_bias_metrics</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span>
    <span class="n">y_pred</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
    <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">df_exp_grad</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_exp_grad</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Disparate Impact Q90</th>
      <td>0.058997</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q80</th>
      <td>0.144811</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q50</th>
      <td>0.455120</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Statistical Parity Q50</th>
      <td>-0.627139</td>
      <td>0</td>
    </tr>
    <tr>
      <th>No Disparate Impact Level</th>
      <td>0.024584</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Average Score Difference</th>
      <td>-0.372666</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Score Ratio</th>
      <td>0.303989</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Z Score Difference</th>
      <td>-1.990870</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Max Statistical Parity</th>
      <td>0.698673</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Statistical Parity AUC</th>
      <td>0.393226</td>
      <td>0</td>
    </tr>
    <tr>
      <th>RMSE Ratio</th>
      <td>0.714597</td>
      <td>1</td>
    </tr>
    <tr>
      <th>RMSE Ratio Q80</th>
      <td>0.845568</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio</th>
      <td>0.690159</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio Q80</th>
      <td>0.889464</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Correlation Difference</th>
      <td>-0.051509</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Evaluate RMSE:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expgrad_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMS error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expgrad_rmse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RMS error: 0.16866594068860602
</pre></div></div>
</div>
</section>
<section id="Post-processing:-Wasserstein-Barycenters">
<h2><strong>Post-processing: Wasserstein Barycenters</strong><a class="headerlink" href="#Post-processing:-Wasserstein-Barycenters" title="Link to this heading">#</a></h2>
<p>Finally, we will implement the “Wasserstein Barycenter” method, a post-processing technique. This method identifies the optimal fair predictor by computing the Wasserstein barycenter of the distributions induced by the standard regression function across sensitive groups.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">WassersteinBarycenter</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">post_processer</span> <span class="o">=</span> <span class="n">WassersteinBarycenter</span><span class="p">()</span>
<span class="n">post_processer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">post_processer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">regression_bias_metrics</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span>
    <span class="n">y_pred</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
    <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">df_wb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_wb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Disparate Impact Q90</th>
      <td>0.609636</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q80</th>
      <td>0.655908</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q50</th>
      <td>0.806293</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Statistical Parity Q50</th>
      <td>-0.097493</td>
      <td>0</td>
    </tr>
    <tr>
      <th>No Disparate Impact Level</th>
      <td>0.237503</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Average Score Difference</th>
      <td>-0.033650</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Score Ratio</th>
      <td>0.868239</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Z Score Difference</th>
      <td>-0.247357</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Max Statistical Parity</th>
      <td>0.180678</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Statistical Parity AUC</th>
      <td>0.064028</td>
      <td>0</td>
    </tr>
    <tr>
      <th>RMSE Ratio</th>
      <td>0.372568</td>
      <td>1</td>
    </tr>
    <tr>
      <th>RMSE Ratio Q80</th>
      <td>0.429231</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio</th>
      <td>0.339849</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio Q80</th>
      <td>0.380852</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Correlation Difference</th>
      <td>0.011022</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Evaluate RMSE:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expgrad_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMS error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expgrad_rmse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RMS error: 0.18983097230624266
</pre></div></div>
</div>
<section id="7.-Results-comparison">
<h3><strong>7. Results comparison</strong><a class="headerlink" href="#7.-Results-comparison" title="Link to this heading">#</a></h3>
<p>Now, we compare the results from the baseline model and the three bias mitigation techniques (Preprocessing, Inprocessing, Postprocessing).</p>
<p><strong>Performance Metrics Overview</strong></p>
<p>Below is a table summarizing key fairness metrics for the baseline model and each bias mitigation technique:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_baseline</span><span class="p">,</span> <span class="n">df_correm</span><span class="p">,</span> <span class="n">df_exp_grad</span><span class="p">,</span> <span class="n">df_wb</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Baseline&#39;</span><span class="p">,</span><span class="s1">&#39;Correlation remover&#39;</span><span class="p">,</span><span class="s2">&quot;Exponentiated gradient&quot;</span><span class="p">,</span> <span class="s2">&quot;Wasserstein barycenters&quot;</span><span class="p">,</span> <span class="s1">&#39;Reference&#39;</span><span class="p">]</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Baseline</th>
      <th>Correlation remover</th>
      <th>Exponentiated gradient</th>
      <th>Wasserstein barycenters</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Disparate Impact Q90</th>
      <td>0.019666</td>
      <td>0.412979</td>
      <td>0.058997</td>
      <td>0.609636</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q80</th>
      <td>0.117994</td>
      <td>0.530973</td>
      <td>0.144811</td>
      <td>0.655908</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Disparate Impact Q50</th>
      <td>0.412979</td>
      <td>0.806293</td>
      <td>0.455120</td>
      <td>0.806293</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Statistical Parity Q50</th>
      <td>-0.705605</td>
      <td>-0.156342</td>
      <td>-0.627139</td>
      <td>-0.097493</td>
      <td>0</td>
    </tr>
    <tr>
      <th>No Disparate Impact Level</th>
      <td>0.056745</td>
      <td>0.202414</td>
      <td>0.024584</td>
      <td>0.237503</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Average Score Difference</th>
      <td>-0.373790</td>
      <td>-0.032719</td>
      <td>-0.372666</td>
      <td>-0.033650</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Score Ratio</th>
      <td>0.308392</td>
      <td>0.871787</td>
      <td>0.303989</td>
      <td>0.868239</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Z Score Difference</th>
      <td>-2.750267</td>
      <td>-0.239919</td>
      <td>-1.990870</td>
      <td>-0.247357</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Max Statistical Parity</th>
      <td>0.767257</td>
      <td>0.216814</td>
      <td>0.698673</td>
      <td>0.180678</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Statistical Parity AUC</th>
      <td>0.452860</td>
      <td>0.107243</td>
      <td>0.393226</td>
      <td>0.064028</td>
      <td>0</td>
    </tr>
    <tr>
      <th>RMSE Ratio</th>
      <td>0.614069</td>
      <td>0.374976</td>
      <td>0.714597</td>
      <td>0.372568</td>
      <td>1</td>
    </tr>
    <tr>
      <th>RMSE Ratio Q80</th>
      <td>0.966421</td>
      <td>0.483447</td>
      <td>0.845568</td>
      <td>0.429231</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio</th>
      <td>0.486594</td>
      <td>0.332584</td>
      <td>0.690159</td>
      <td>0.339849</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MAE Ratio Q80</th>
      <td>0.937572</td>
      <td>0.434959</td>
      <td>0.889464</td>
      <td>0.380852</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Correlation Difference</th>
      <td>0.002428</td>
      <td>0.002576</td>
      <td>-0.051509</td>
      <td>0.011022</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Overall, for this particular case, the bias mitigation techniques demonstrate varying degrees of success in improving fairness metrics compared to the baseline model. The <strong>Wasserstein Barycenters</strong> method consistently outperforms the others across most metrics, closely approaching the reference values and significantly reducing bias. The <strong>Correlation Remover</strong> also shows notable improvements but to a lesser extent. The <strong>Exponentiated Gradient</strong> method, while better than the baseline, is less
effective compared to the other two methods. This analysis highlights the importance of choosing the appropriate bias mitigation strategy to achieve fairer model predictions.</p>
</section>
<section id="Summary">
<h3><strong>Summary</strong><a class="headerlink" href="#Summary" title="Link to this heading">#</a></h3>
<p>In this tutorial, we could observe how to address and mitigate bias in machine learning models for the regression task case. We utilized the <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> library for this purpose to measure bias in our baseline model, using a variety of fairness metrics. Observing substantial bias, we explored three categories of bias mitigation techniques: pre-processing, in-processing, and post-processing. Specifically, we implemented the Correlation Remover as a pre-processing technique, the Exponentiated
Gradient as an in-processing method, and the Wasserstein Barycenters as a post-processing strategy. Finally, we compared the performance of these mitigators against the baseline model. Our results showed that while all methods improved fairness to some extent, the Wasserstein Barycenters technique achieved the most significant reduction in bias across various metrics.</p>
<p>For more information about other bias mitigation techniques and advanced features consult the <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> documentation.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Holistic AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>