

<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Packages Installation &#8212; holistic  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/css/custom_style.css?v=ac75cb35" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/tutorials/bias/mitigating_bias/binary_classification/demos/preprocessing';</script>
    <link rel="icon" href="../../../../../../_static/holistic_ai.png"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../../_static/hai_logo.svg" class="logo__image only-light" alt="holistic  documentation - Home"/>
    <img src="https://assets-global.website-files.com/6305e5d42c283515c3e71b8c/63d771efd50a073bd66193f0_Holistic-AI-Logo-Horizontal-Dark.svg" class="logo__image only-dark pst-js-only" alt="holistic  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Packages Installation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Packages-Installation">
<h1>Packages Installation<a class="headerlink" href="#Packages-Installation" title="Link to this heading">#</a></h1>
<p>First, install the <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> package if you havenâ€™t already:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>!pip<span class="w"> </span>install<span class="w"> </span>holisticai<span class="o">[</span>all<span class="o">]</span>
</pre></div>
</div>
<p>Then, import the necessary libraries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">holistic.bias.metrics</span> <span class="kn">import</span> <span class="n">classification_bias_metrics</span>
<span class="kn">from</span> <span class="nn">holistic.datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">holistic.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</section>
<section id="Dataset-loading">
<h1>Dataset loading<a class="headerlink" href="#Dataset-loading" title="Link to this heading">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;adult&#39;</span><span class="p">,</span> <span class="n">protected_attribute</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span>
<span class="n">train_test</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>

<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container blue first-level">
        <div class="generic-object-content">
            <div class="generic-object-header blue" onclick="toggleCollapse(this)">
                <button class="toggle-button blue">[-]</button> [Dataset]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list blue"><strong>Instances</strong>: 45222</div><div class="attribute-list blue"><strong>Features</strong>: X , y , p_attrs , group_a , group_b</div><div class="attribute-list blue"><strong>Metadata</strong>: sex: {'group_a': 'Male', 'group_b': 'Female'}</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
<section id="1-.-Correlation-Remover">
<h2>1 . Correlation Remover<a class="headerlink" href="#1-.-Correlation-Remover" title="Link to this heading">#</a></h2>
<section id="Traditional-Implementation">
<h3>Traditional Implementation<a class="headerlink" href="#Traditional-Implementation" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define postprocessing model</span>
<span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">CorrelationRemover</span>

<span class="n">mitigator</span> <span class="o">=</span> <span class="n">CorrelationRemover</span><span class="p">()</span>
<span class="n">mitigator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container orange first-level">
        <div class="generic-object-content">
            <div class="generic-object-header orange" onclick="toggleCollapse(this)">
                <button class="toggle-button orange">[-]</button> [CorrelationRemover]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list orange"><center>CorrelationRemover(alpha=1)</center></div><hr><div class="attribute-list orange"><strong>Type</strong>: Bias Mitigation Preprocessing</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
</section>
</section>
</section>
<section id="Training-a-Model">
<h1>Training a Model<a class="headerlink" href="#Training-a-Model" title="Link to this heading">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># Standardize data and fit model</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">X_train_pre</span> <span class="o">=</span> <span class="n">mitigator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">group_a</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">group_b</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pre</span><span class="p">,</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Predict on test data</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span>
<span class="n">X_test_pre</span> <span class="o">=</span> <span class="n">mitigator</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">group_a</span><span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">group_b</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pre</span><span class="p">)</span>

<span class="c1"># Evaluate bias metrics</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classification_bias_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Statistical Parity</th>
      <td>0.088938</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Disparate Impact</th>
      <td>1.732300</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Four Fifths Rule</th>
      <td>0.577267</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cohen D</th>
      <td>0.232029</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2SD Rule</th>
      <td>10.260307</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Equality of Opportunity Difference</th>
      <td>-0.099203</td>
      <td>0</td>
    </tr>
    <tr>
      <th>False Positive Rate Difference</th>
      <td>0.011345</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Odds Difference</th>
      <td>-0.043929</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Accuracy Difference</th>
      <td>-0.097202</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define postprocessing model</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">CorrelationRemover</span><span class="p">()</span>
<span class="n">mitigator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container orange first-level">
        <div class="generic-object-content">
            <div class="generic-object-header orange" onclick="toggleCollapse(this)">
                <button class="toggle-button orange">[-]</button> [CorrelationRemover]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list orange"><center>CorrelationRemover(alpha=1)</center></div><hr><div class="attribute-list orange"><strong>Type</strong>: Bias Mitigation Preprocessing</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define pretprocessing model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># Define pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;bm_preprocessing&quot;</span><span class="p">,</span> <span class="n">mitigator</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">),])</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>
<span class="n">pipeline</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container green first-level">
        <div class="generic-object-content">
            <div class="generic-object-header green" onclick="toggleCollapse(this)">
                <button class="toggle-button green">[-]</button> [Pipeline]
            </div>
            <div class="generic-object-body">


    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container green first-level">
        <div class="generic-object-content">
            <div class="generic-object-header green" onclick="toggleCollapse(this)">
                <button class="toggle-button green">[-]</button> scalar [StandardScaler]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list green"><center>StandardScaler(copy=True, with_mean=True, with_std=True)</center></div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container green first-level">
        <div class="generic-object-content">
            <div class="generic-object-header green" onclick="toggleCollapse(this)">
                <button class="toggle-button green">[-]</button> bm_preprocessing [CorrelationRemover]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list green"><center>CorrelationRemover(alpha=1)</center></div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container green first-level">
        <div class="generic-object-content">
            <div class="generic-object-header green" onclick="toggleCollapse(this)">
                <button class="toggle-button green">[-]</button> estimator [LogisticRegression]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list green"><center>LogisticRegression(penalty=l2, dual=False, tol=0.0001, C=1.0, ...)</center></div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make predictions</span>
<span class="n">y_pred_pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Evaluate bias metrics for pipeline model</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;CorrelationRemover&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">classification_bias_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span> <span class="n">y_pred_pipeline</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;CorrelationRemover&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Statistical Parity</th>
      <td>0.088938</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Disparate Impact</th>
      <td>1.732300</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Four Fifths Rule</th>
      <td>0.577267</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cohen D</th>
      <td>0.232029</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2SD Rule</th>
      <td>10.260307</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Equality of Opportunity Difference</th>
      <td>-0.099203</td>
      <td>0</td>
    </tr>
    <tr>
      <th>False Positive Rate Difference</th>
      <td>0.011345</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Odds Difference</th>
      <td>-0.043929</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Accuracy Difference</th>
      <td>-0.097202</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="2.-Disparate-Impact-Remover">
<h2>2. Disparate Impact Remover<a class="headerlink" href="#2.-Disparate-Impact-Remover" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Traditional Implementation<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define postprocessing model</span>
<span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">DisparateImpactRemover</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">DisparateImpactRemover</span><span class="p">()</span>
<span class="n">mitigator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container orange first-level">
        <div class="generic-object-content">
            <div class="generic-object-header orange" onclick="toggleCollapse(this)">
                <button class="toggle-button orange">[-]</button> [DisparateImpactRemover]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list orange"><center>DisparateImpactRemover(repair_level=1.0)</center></div><hr><div class="attribute-list orange"><strong>Type</strong>: Bias Mitigation Preprocessing</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
</section>
<section id="Pipeline-Implementation">
<h3>Pipeline Implementation<a class="headerlink" href="#Pipeline-Implementation" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define preprocessing model</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">DisparateImpactRemover</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># Define pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;bm_preprocessing&quot;</span><span class="p">,</span> <span class="n">mitigator</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">),])</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Make predictions</span>
<span class="n">y_pred_pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Evaluate bias metrics for pipeline model</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;DisparateImpactRemover&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">classification_bias_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span> <span class="n">y_pred_pipeline</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;DisparateImpactRemover&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Statistical Parity</th>
      <td>0.453053</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Disparate Impact</th>
      <td>7.791141</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Four Fifths Rule</th>
      <td>0.128351</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cohen D</th>
      <td>1.041918</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2SD Rule</th>
      <td>41.661359</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Equality of Opportunity Difference</th>
      <td>0.431984</td>
      <td>0</td>
    </tr>
    <tr>
      <th>False Positive Rate Difference</th>
      <td>0.340087</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Odds Difference</th>
      <td>0.386036</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Accuracy Difference</th>
      <td>-0.204678</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="3.-Learning-Fair-Representations">
<h2>3. Learning Fair Representations<a class="headerlink" href="#3.-Learning-Fair-Representations" title="Link to this heading">#</a></h2>
<section id="id2">
<h3>Traditional Implementation<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define postprocessing model</span>
<span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">LearningFairRepresentation</span>

<span class="n">mitigator</span> <span class="o">=</span> <span class="n">LearningFairRepresentation</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Ax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">Ay</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">Az</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mitigator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container orange first-level">
        <div class="generic-object-content">
            <div class="generic-object-header orange" onclick="toggleCollapse(this)">
                <button class="toggle-button orange">[-]</button> [LearningFairRepresentation]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list orange"><center>LearningFairRepresentation(k=10, Ax=0.2, Ay=2.0, Az=4.0, ...)</center></div><hr><div class="attribute-list orange"><strong>Type</strong>: Bias Mitigation Preprocessing</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
</section>
<section id="id3">
<h3>Pipeline Implementation<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define postprocessing model</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">LearningFairRepresentation</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Ax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">Ay</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">Az</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># Define pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;bm_preprocessing&quot;</span><span class="p">,</span> <span class="n">mitigator</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">),])</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Make predictions</span>
<span class="n">y_pred_pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Evaluate bias metrics for pipeline model</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;LearningFR&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">classification_bias_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span> <span class="n">y_pred_pipeline</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;LearningFR&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[34], line 7</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span style="color: rgb(95,135,135)"># Define pipeline</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> pipeline <span style="color: rgb(98,98,98)">=</span> Pipeline(steps<span style="color: rgb(98,98,98)">=</span>[(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">scalar</span><span style="color: rgb(175,0,0)">&#39;</span>, StandardScaler()), (<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">bm_preprocessing</span><span style="color: rgb(175,0,0)">&#34;</span>, mitigator), (<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">estimator</span><span style="color: rgb(175,0,0)">&#34;</span>, model),])
<span class="ansi-green-fg">----&gt; 7</span> <span class="ansi-yellow-bg">pipeline</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">X</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">y</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">bm__group_a</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">group_a</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">bm__group_b</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">group_b</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> <span style="color: rgb(95,135,135)"># Make predictions</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> y_pred_pipeline <span style="color: rgb(98,98,98)">=</span> pipeline<span style="color: rgb(98,98,98)">.</span>predict(test[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">X</span><span style="color: rgb(175,0,0)">&#39;</span>], bm__group_a<span style="color: rgb(98,98,98)">=</span>test[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">group_a</span><span style="color: rgb(175,0,0)">&#39;</span>], bm__group_b<span style="color: rgb(98,98,98)">=</span>test[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">group_b</span><span style="color: rgb(175,0,0)">&#39;</span>])

File <span class="ansi-green-fg">~/holisticai/src/holisticai/pipeline/_pipeline_helper.py:55</span>, in <span class="ansi-cyan-fg">PipelineHelper.handle_pipeline_methods.&lt;locals&gt;.function</span><span class="ansi-blue-fg">(X, y, **kargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span>         output <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">object</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__getattribute__</span>(<span style="color: rgb(0,135,0)">self</span>, fn_name)(X, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>params)
<span class="ansi-green-intense-fg ansi-bold">     53</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">     54</span>     <span style="color: rgb(95,135,135)"># Other case the primitive method could be invoked</span>
<span class="ansi-green-fg">---&gt; 55</span>     output <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">getattr</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">SKLPipeline</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">fn_name</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> output

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/sklearn/base.py:1473</span>, in <span class="ansi-cyan-fg">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg">(estimator, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1466</span>     estimator<span style="color: rgb(98,98,98)">.</span>_validate_params()
<span class="ansi-green-intense-fg ansi-bold">   1468</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> config_context(
<span class="ansi-green-intense-fg ansi-bold">   1469</span>     skip_parameter_validation<span style="color: rgb(98,98,98)">=</span>(
<span class="ansi-green-intense-fg ansi-bold">   1470</span>         prefer_skip_nested_validation <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> global_skip_validation
<span class="ansi-green-intense-fg ansi-bold">   1471</span>     )
<span class="ansi-green-intense-fg ansi-bold">   1472</span> ):
<span class="ansi-green-fg">-&gt; 1473</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">fit_method</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">estimator</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/sklearn/pipeline.py:469</span>, in <span class="ansi-cyan-fg">Pipeline.fit</span><span class="ansi-blue-fg">(self, X, y, **params)</span>
<span class="ansi-green-intense-fg ansi-bold">    426</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;Fit the model.</span>
<span class="ansi-green-intense-fg ansi-bold">    427</span>
<span class="ansi-green-intense-fg ansi-bold">    428</span> <span style="color: rgb(175,0,0)">Fit all the transformers one after the other and sequentially transform the</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    466</span> <span style="color: rgb(175,0,0)">    Pipeline with fitted steps.</span>
<span class="ansi-green-intense-fg ansi-bold">    467</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    468</span> routed_params <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_check_method_params(method<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">fit</span><span style="color: rgb(175,0,0)">&#34;</span>, props<span style="color: rgb(98,98,98)">=</span>params)
<span class="ansi-green-fg">--&gt; 469</span> Xt <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">routed_params</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    470</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Pipeline</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_log_message(<span style="color: rgb(0,135,0)">len</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps) <span style="color: rgb(98,98,98)">-</span> <span style="color: rgb(98,98,98)">1</span>)):
<span class="ansi-green-intense-fg ansi-bold">    471</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_final_estimator <span style="color: rgb(98,98,98)">!=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">passthrough</span><span style="color: rgb(175,0,0)">&#34;</span>:

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/sklearn/pipeline.py:406</span>, in <span class="ansi-cyan-fg">Pipeline._fit</span><span class="ansi-blue-fg">(self, X, y, routed_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    404</span>     cloned_transformer <span style="color: rgb(98,98,98)">=</span> clone(transformer)
<span class="ansi-green-intense-fg ansi-bold">    405</span> <span style="color: rgb(95,135,135)"># Fit or load from cache the current transformer</span>
<span class="ansi-green-fg">--&gt; 406</span> X, fitted_transformer <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fit_transform_one_cached</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    407</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">cloned_transformer</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    408</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    409</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    410</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">None</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    411</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message_clsname</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Pipeline</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    412</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">message</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_log_message</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">step_idx</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    413</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">routed_params</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    414</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    415</span> <span style="color: rgb(95,135,135)"># Replace the transformer of the step with the fitted</span>
<span class="ansi-green-intense-fg ansi-bold">    416</span> <span style="color: rgb(95,135,135)"># transformer. This is necessary when loading the transformer</span>
<span class="ansi-green-intense-fg ansi-bold">    417</span> <span style="color: rgb(95,135,135)"># from the cache.</span>
<span class="ansi-green-intense-fg ansi-bold">    418</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>steps[step_idx] <span style="color: rgb(98,98,98)">=</span> (name, fitted_transformer)

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/joblib/memory.py:312</span>, in <span class="ansi-cyan-fg">NotMemorizedFunc.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    311</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__call__</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 312</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/sklearn/pipeline.py:1310</span>, in <span class="ansi-cyan-fg">_fit_transform_one</span><span class="ansi-blue-fg">(transformer, X, y, weight, message_clsname, message, params)</span>
<span class="ansi-green-intense-fg ansi-bold">   1308</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _print_elapsed_time(message_clsname, message):
<span class="ansi-green-intense-fg ansi-bold">   1309</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">hasattr</span>(transformer, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">fit_transform</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-fg">-&gt; 1310</span>         res <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">transformer</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">get</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">fit_transform</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">{</span><span class="ansi-yellow-bg">}</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1311</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   1312</span>         res <span style="color: rgb(98,98,98)">=</span> transformer<span style="color: rgb(98,98,98)">.</span>fit(X, y, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>params<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">fit</span><span style="color: rgb(175,0,0)">&#34;</span>, {}))<span style="color: rgb(98,98,98)">.</span>transform(
<span class="ansi-green-intense-fg ansi-bold">   1313</span>             X, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>params<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">transform</span><span style="color: rgb(175,0,0)">&#34;</span>, {})
<span class="ansi-green-intense-fg ansi-bold">   1314</span>         )

File <span class="ansi-green-fg">~/holisticai/src/holisticai/utils/transformers/_transformer_base.py:92</span>, in <span class="ansi-cyan-fg">BMTransformerBase.reformat_function.&lt;locals&gt;.wrapped_func</span><span class="ansi-blue-fg">(*args, **kargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span> kargs<span style="color: rgb(98,98,98)">.</span>update(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_load_data_pipeline())
<span class="ansi-green-intense-fg ansi-bold">     91</span> params <span style="color: rgb(98,98,98)">=</span> {v: kargs[v] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> v <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> fun_varnames <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> v <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> kargs}
<span class="ansi-green-fg">---&gt; 92</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/holisticai/src/holisticai/bias/mitigation/preprocessing/learning_fair_representation.py:272</span>, in <span class="ansi-cyan-fg">LearningFairRepresentation.fit_transform</span><span class="ansi-blue-fg">(self, X, y, group_a, group_b)</span>
<span class="ansi-green-intense-fg ansi-bold">    247</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">fit_transform</span>(
<span class="ansi-green-intense-fg ansi-bold">    248</span>     <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-intense-fg ansi-bold">    249</span>     X: np<span style="color: rgb(98,98,98)">.</span>ndarray,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>     group_b: np<span style="color: rgb(98,98,98)">.</span>ndarray,
<span class="ansi-green-intense-fg ansi-bold">    253</span> ):
<span class="ansi-green-intense-fg ansi-bold">    254</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    255</span> <span style="color: rgb(175,0,0)">    Fit and transform</span>
<span class="ansi-green-intense-fg ansi-bold">    256</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span> <span style="color: rgb(175,0,0)">        Self</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span> <span style="color: rgb(175,0,0)">    &#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 272</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">group_a</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">group_b</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>transform(X, group_a, group_b)

File <span class="ansi-green-fg">~/holisticai/src/holisticai/utils/transformers/_transformer_base.py:92</span>, in <span class="ansi-cyan-fg">BMTransformerBase.reformat_function.&lt;locals&gt;.wrapped_func</span><span class="ansi-blue-fg">(*args, **kargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span> kargs<span style="color: rgb(98,98,98)">.</span>update(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_load_data_pipeline())
<span class="ansi-green-intense-fg ansi-bold">     91</span> params <span style="color: rgb(98,98,98)">=</span> {v: kargs[v] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> v <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> fun_varnames <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> v <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> kargs}
<span class="ansi-green-fg">---&gt; 92</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">params</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/holisticai/src/holisticai/bias/mitigation/preprocessing/learning_fair_representation.py:203</span>, in <span class="ansi-cyan-fg">LearningFairRepresentation.fit</span><span class="ansi-blue-fg">(self, X, y, group_a, group_b)</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span> <span style="color: rgb(175,0,255)">@jax</span><span style="color: rgb(98,98,98)">.</span>jit
<span class="ansi-green-intense-fg ansi-bold">    200</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">objective</span>(params):
<span class="ansi-green-intense-fg ansi-bold">    201</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> obj_fun(params)
<span class="ansi-green-fg">--&gt; 203</span> result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">minimize</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    204</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">objective</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    205</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">parameters_initialization</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">method</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">L-BFGS-B</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">parameters_bounds</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    208</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">options</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">{</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">maxiter</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">maxiter</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">disp</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">0</span><span class="ansi-yellow-bg">}</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    209</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>learned_model <span style="color: rgb(98,98,98)">=</span> result<span style="color: rgb(98,98,98)">.</span>x
<span class="ansi-green-intense-fg ansi-bold">    211</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>w <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>learned_model[: <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>k]

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_minimize.py:731</span>, in <span class="ansi-cyan-fg">minimize</span><span class="ansi-blue-fg">(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)</span>
<span class="ansi-green-intense-fg ansi-bold">    728</span>     res <span style="color: rgb(98,98,98)">=</span> _minimize_newtoncg(fun, x0, args, jac, hess, hessp, callback,
<span class="ansi-green-intense-fg ansi-bold">    729</span>                              <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>options)
<span class="ansi-green-intense-fg ansi-bold">    730</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> meth <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">l-bfgs-b</span><span style="color: rgb(175,0,0)">&#39;</span>:
<span class="ansi-green-fg">--&gt; 731</span>     res <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_minimize_lbfgsb</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">jac</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    732</span> <span class="ansi-yellow-bg">                           </span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">options</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    733</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> meth <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">tnc</span><span style="color: rgb(175,0,0)">&#39;</span>:
<span class="ansi-green-intense-fg ansi-bold">    734</span>     res <span style="color: rgb(98,98,98)">=</span> _minimize_tnc(fun, x0, args, jac, bounds, callback<span style="color: rgb(98,98,98)">=</span>callback,
<span class="ansi-green-intense-fg ansi-bold">    735</span>                         <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>options)

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_lbfgsb_py.py:347</span>, in <span class="ansi-cyan-fg">_minimize_lbfgsb</span><span class="ansi-blue-fg">(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)</span>
<span class="ansi-green-intense-fg ansi-bold">    344</span>         iprint <span style="color: rgb(98,98,98)">=</span> disp
<span class="ansi-green-intense-fg ansi-bold">    346</span> <span style="color: rgb(95,135,135)"># _prepare_scalar_function can use bounds=None to represent no bounds</span>
<span class="ansi-green-fg">--&gt; 347</span> sf <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_prepare_scalar_function</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">jac</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">jac</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">epsilon</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">eps</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span class="ansi-yellow-bg">                              </span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    349</span> <span class="ansi-yellow-bg">                              </span><span class="ansi-yellow-bg">finite_diff_rel_step</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">finite_diff_rel_step</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    351</span> func_and_grad <span style="color: rgb(98,98,98)">=</span> sf<span style="color: rgb(98,98,98)">.</span>fun_and_grad
<span class="ansi-green-intense-fg ansi-bold">    353</span> fortran_int <span style="color: rgb(98,98,98)">=</span> _lbfgsb<span style="color: rgb(98,98,98)">.</span>types<span style="color: rgb(98,98,98)">.</span>intvar<span style="color: rgb(98,98,98)">.</span>dtype

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_optimize.py:288</span>, in <span class="ansi-cyan-fg">_prepare_scalar_function</span><span class="ansi-blue-fg">(fun, x0, jac, args, bounds, epsilon, finite_diff_rel_step, hess)</span>
<span class="ansi-green-intense-fg ansi-bold">    284</span>     bounds <span style="color: rgb(98,98,98)">=</span> (<span style="color: rgb(98,98,98)">-</span>np<span style="color: rgb(98,98,98)">.</span>inf, np<span style="color: rgb(98,98,98)">.</span>inf)
<span class="ansi-green-intense-fg ansi-bold">    286</span> <span style="color: rgb(95,135,135)"># ScalarFunction caches. Reuse of fun(x) during grad</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span> <span style="color: rgb(95,135,135)"># calculation reduces overall function evaluations.</span>
<span class="ansi-green-fg">--&gt; 288</span> sf <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ScalarFunction</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">grad</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">hess</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span> <span class="ansi-yellow-bg">                    </span><span class="ansi-yellow-bg">finite_diff_rel_step</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">epsilon</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">epsilon</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    291</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> sf

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_differentiable_functions.py:231</span>, in <span class="ansi-cyan-fg">ScalarFunction.__init__</span><span class="ansi-blue-fg">(self, fun, x0, args, grad, hess, finite_diff_rel_step, finite_diff_bounds, epsilon)</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span> <span style="color: rgb(95,135,135)"># Initial gradient evaluation</span>
<span class="ansi-green-intense-fg ansi-bold">    225</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_wrapped_grad, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_ngev <span style="color: rgb(98,98,98)">=</span> _wrapper_grad(
<span class="ansi-green-intense-fg ansi-bold">    226</span>     grad,
<span class="ansi-green-intense-fg ansi-bold">    227</span>     fun<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_wrapped_fun,
<span class="ansi-green-intense-fg ansi-bold">    228</span>     args<span style="color: rgb(98,98,98)">=</span>args,
<span class="ansi-green-intense-fg ansi-bold">    229</span>     finite_diff_options<span style="color: rgb(98,98,98)">=</span>finite_diff_options
<span class="ansi-green-intense-fg ansi-bold">    230</span> )
<span class="ansi-green-fg">--&gt; 231</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_update_grad</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    233</span> <span style="color: rgb(95,135,135)"># Hessian evaluation</span>
<span class="ansi-green-intense-fg ansi-bold">    234</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">callable</span>(hess):

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_differentiable_functions.py:306</span>, in <span class="ansi-cyan-fg">ScalarFunction._update_grad</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    304</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_orig_grad <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> FD_METHODS:
<span class="ansi-green-intense-fg ansi-bold">    305</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_update_fun()
<span class="ansi-green-fg">--&gt; 306</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>g <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_wrapped_grad</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">f0</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">f</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    307</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>g_updated <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_differentiable_functions.py:47</span>, in <span class="ansi-cyan-fg">_wrapper_grad.&lt;locals&gt;.wrapped1</span><span class="ansi-blue-fg">(x, f0)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">wrapped1</span>(x, f0<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>):
<span class="ansi-green-intense-fg ansi-bold">     46</span>     ncalls[<span style="color: rgb(98,98,98)">0</span>] <span style="color: rgb(98,98,98)">+</span><span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">1</span>
<span class="ansi-green-fg">---&gt; 47</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">approx_derivative</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">     48</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">f0</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">f0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">finite_diff_options</span>
<span class="ansi-green-intense-fg ansi-bold">     49</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_numdiff.py:519</span>, in <span class="ansi-cyan-fg">approx_derivative</span><span class="ansi-blue-fg">(fun, x0, method, rel_step, abs_step, f0, bounds, sparsity, as_linear_operator, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    516</span>     use_one_sided <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> sparsity <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 519</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">_dense_difference</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">fun_wrapped</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">f0</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">h</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    520</span> <span class="ansi-yellow-bg">                             </span><span class="ansi-yellow-bg">use_one_sided</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">method</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    521</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    522</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> issparse(sparsity) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">len</span>(sparsity) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(98,98,98)">2</span>:

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_numdiff.py:592</span>, in <span class="ansi-cyan-fg">_dense_difference</span><span class="ansi-blue-fg">(fun, x0, f0, h, use_one_sided, method)</span>
<span class="ansi-green-intense-fg ansi-bold">    590</span>     x1[i] <span style="color: rgb(98,98,98)">+</span><span style="color: rgb(98,98,98)">=</span> h[i]
<span class="ansi-green-intense-fg ansi-bold">    591</span>     dx <span style="color: rgb(98,98,98)">=</span> x1[i] <span style="color: rgb(98,98,98)">-</span> x0[i]  <span style="color: rgb(95,135,135)"># Recompute dx as exactly representable number.</span>
<span class="ansi-green-fg">--&gt; 592</span>     df <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x1</span><span class="ansi-yellow-bg">)</span> <span style="color: rgb(98,98,98)">-</span> f0
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> method <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">3-point</span><span style="color: rgb(175,0,0)">&#39;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> use_one_sided[i]:
<span class="ansi-green-intense-fg ansi-bold">    594</span>     x1[i] <span style="color: rgb(98,98,98)">+</span><span style="color: rgb(98,98,98)">=</span> h[i]

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_numdiff.py:470</span>, in <span class="ansi-cyan-fg">approx_derivative.&lt;locals&gt;.fun_wrapped</span><span class="ansi-blue-fg">(x)</span>
<span class="ansi-green-intense-fg ansi-bold">    467</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> xp<span style="color: rgb(98,98,98)">.</span>isdtype(x<span style="color: rgb(98,98,98)">.</span>dtype, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">real floating</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-intense-fg ansi-bold">    468</span>     x <span style="color: rgb(98,98,98)">=</span> xp<span style="color: rgb(98,98,98)">.</span>astype(x, x0<span style="color: rgb(98,98,98)">.</span>dtype)
<span class="ansi-green-fg">--&gt; 470</span> f <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>atleast_1d(<span class="ansi-yellow-bg">fun</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-intense-fg ansi-bold">    471</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> f<span style="color: rgb(98,98,98)">.</span>ndim <span style="color: rgb(98,98,98)">&gt;</span> <span style="color: rgb(98,98,98)">1</span>:
<span class="ansi-green-intense-fg ansi-bold">    472</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">RuntimeError</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">`fun` return value has </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    473</span>                        <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">more than 1 dimension.</span><span style="color: rgb(175,0,0)">&#34;</span>)

File <span class="ansi-green-fg">~/.local/share/hatch/env/virtual/holisticai/4NjQH6EQ/testing/lib/python3.11/site-packages/scipy/optimize/_differentiable_functions.py:24</span>, in <span class="ansi-cyan-fg">_wrapper_fun.&lt;locals&gt;.wrapped</span><span class="ansi-blue-fg">(x)</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> np<span style="color: rgb(98,98,98)">.</span>isscalar(fx):
<span class="ansi-green-intense-fg ansi-bold">     23</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">---&gt; 24</span>         fx <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>asarray(fx)<span style="color: rgb(98,98,98)">.</span>item()
<span class="ansi-green-intense-fg ansi-bold">     25</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> (<span class="ansi-bold" style="color: rgb(215,95,95)">TypeError</span>, <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-intense-fg ansi-bold">     26</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(
<span class="ansi-green-intense-fg ansi-bold">     27</span>             <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">The user-provided objective function </span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span>             <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">must return a scalar value.</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     29</span>         ) <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">e</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
</section>
</section>
<section id="4.-Reweighing">
<h2>4. Reweighing<a class="headerlink" href="#4.-Reweighing" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>Traditional Implementation<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define preprocessing model</span>
<span class="kn">from</span> <span class="nn">holistic.bias.mitigation</span> <span class="kn">import</span> <span class="n">Reweighing</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">Reweighing</span><span class="p">()</span>
<span class="n">mitigator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Light blue theme (default) */
.generic-object-container.blue {
    background-color: rgba(242, 248, 253, 0.9) !important; /* Light blue with 70% opacity */
    border-color: #4db6ac !important; /* Soft blue border */
}

.generic-object-header.blue {
    background-color: rgba(152, 171, 202, 0.4) !important; /* Darker blue with 60% opacity */
}

.generic-object-header.blue:hover {
    background-color: rgba(139, 177, 192, 0.8) !important; /* Darker blue on hover with 60% opacity */
}

.attribute-list.blue:hover {
    background-color: rgba(178, 223, 219, 0.8) !important; /* Attribute hover background with 60% opacity */
}

/* Orange theme */
.generic-object-container.orange {
    background-color: #fff9ef !important; /* Container background: light orange */
    border-color: #ffb74d !important; /* Soft orange border */
}

.generic-object-header.orange {
    background-color: #ffe0b2 !important; /* Header background: darker orange */
}

.generic-object-header.orange:hover {
    background-color: #ffcc80 !important; /* Darker shade on hover over the header */
}

.attribute-list.orange:hover {
    background-color: #ffe0b2 !important; /* Attribute background on hover: darker orange */
}

/* Green theme */
.generic-object-container.green {
    background-color: #f6fff6 !important; /* Container background: light green */
    border-color: #81c784 !important; /* Soft green border */
}

.generic-object-header.green {
    background-color: #c8e6c9 !important; /* Header background: darker green */
}

.generic-object-header.green:hover {
    background-color: #a5d6a7 !important; /* Darker shade on hover over the header */
}

.attribute-list.green:hover {
    background-color: #c8e6c9 !important; /* Attribute background on hover: darker green */
}

/* Align the first container to the left */
.generic-object-container.first-level {
    margin: 0;
    width: auto;
    max-width: 800px;
    display: block;
    box-sizing: border-box;
}

/* Nested containers stay centered */
.generic-object-container .generic-object-container {
    margin: 5px auto;
    width: 100%;
    display: block;
    padding: 5px 0;
}

/* Remove default background color so only themes apply it */
.generic-object-container {
    padding: 0;
    margin: 0 auto;
    border: 0px dashed;
    border-radius: 5px;
    display: block;
    width: auto;
    max-width: 800px;
    box-sizing: border-box;
    margin-bottom: 15px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0px 2px 5px rgba(77, 182, 172, 0.3);
}

.generic-object-container:hover {
    box-shadow: 0px 8px 20px rgba(77, 182, 172, 0.3);
}

.generic-object-header {
    font-family: 'Montserrat', Arial, sans-serif;
    font-size: 14px;
    padding: 10px 20px;
    padding-left: 40px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.toggle-button {
    margin-right: 10px;
    background: none;
    border: none;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    left: 10px;
    color: #004d40;
}

.generic-object-body {
    padding: 5px 10px;
    display: block;
    border-radius: 0 0 5px 5px;
    background-color: inherit;
    margin: 0 auto;
}

.hidden {
    display: none;
}

.attribute-list {
    margin: 2px 0;
    padding: 2px;
    transition: background-color 0.2s;
    display: block;
}

.flex-space-filler {
    display: flex;
    justify-content: center;
    align-items: center;
}

.generic-object-container,
.generic-object-header,
.attribute-list {
    color: #000000 !important; /* Establece el color del texto a negro */
}
    </style>
    <div style="display: flex;">
    <div class="generic-object-container orange first-level">
        <div class="generic-object-content">
            <div class="generic-object-header orange" onclick="toggleCollapse(this)">
                <button class="toggle-button orange">[-]</button> [Reweighing]
            </div>
            <div class="generic-object-body">
                <div class="attribute-list orange"><center>Reweighing()</center></div><hr><div class="attribute-list orange"><strong>Type</strong>: Bias Mitigation Preprocessing</div>

            </div>
        </div>
    </div>
</div>
    <script>
    function toggleCollapse(element) {
        var body = element.nextElementSibling;
        var button = element.querySelector(".toggle-button");
        if (body.classList.contains('hidden')) {
            body.classList.remove('hidden');
            button.textContent = "[-]";
        } else {
            body.classList.add('hidden');
            button.textContent = "[+]";
        }
    }
    </script></div>
</div>
</section>
<section id="id5">
<h3>Pipeline Implementation<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define preprocessing model</span>
<span class="n">mitigator</span> <span class="o">=</span> <span class="n">Reweighing</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># Define pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;bm_preprocessing&quot;</span><span class="p">,</span> <span class="n">mitigator</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">),])</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Make predictions</span>
<span class="n">y_pred_pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bm__group_a</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">bm__group_b</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">])</span>

<span class="c1"># Evaluate bias metrics for pipeline model</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;Reweighing&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">classification_bias_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;group_b&#39;</span><span class="p">],</span> <span class="n">y_pred_pipeline</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">metric_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;Reweighing&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Value</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Statistical Parity</th>
      <td>0.094554</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Disparate Impact</th>
      <td>1.787408</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Four Fifths Rule</th>
      <td>0.559469</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cohen D</th>
      <td>0.245580</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2SD Rule</th>
      <td>10.851962</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Equality of Opportunity Difference</th>
      <td>-0.107801</td>
      <td>0</td>
    </tr>
    <tr>
      <th>False Positive Rate Difference</th>
      <td>0.018112</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Odds Difference</th>
      <td>-0.044845</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Accuracy Difference</th>
      <td>-0.102319</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.utils</span> <span class="kn">import</span> <span class="n">concatenate_metrics</span>

<span class="n">concatenate_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>CorrelationRemover</th>
      <th>DisparateImpactRemover</th>
      <th>Reweighing</th>
      <th>Reference</th>
    </tr>
    <tr>
      <th>Metric</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Statistical Parity</th>
      <td>0.088938</td>
      <td>0.088938</td>
      <td>0.453053</td>
      <td>0.094554</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Disparate Impact</th>
      <td>1.732300</td>
      <td>1.732300</td>
      <td>7.791141</td>
      <td>1.787408</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Four Fifths Rule</th>
      <td>0.577267</td>
      <td>0.577267</td>
      <td>0.128351</td>
      <td>0.559469</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cohen D</th>
      <td>0.232029</td>
      <td>0.232029</td>
      <td>1.041918</td>
      <td>0.245580</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2SD Rule</th>
      <td>10.260307</td>
      <td>10.260307</td>
      <td>41.661359</td>
      <td>10.851962</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Equality of Opportunity Difference</th>
      <td>-0.099203</td>
      <td>-0.099203</td>
      <td>0.431984</td>
      <td>-0.107801</td>
      <td>0</td>
    </tr>
    <tr>
      <th>False Positive Rate Difference</th>
      <td>0.011345</td>
      <td>0.011345</td>
      <td>0.340087</td>
      <td>0.018112</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Average Odds Difference</th>
      <td>-0.043929</td>
      <td>-0.043929</td>
      <td>0.386036</td>
      <td>-0.044845</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Accuracy Difference</th>
      <td>-0.097202</td>
      <td>-0.097202</td>
      <td>-0.204678</td>
      <td>-0.102319</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2024, Holistic AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>