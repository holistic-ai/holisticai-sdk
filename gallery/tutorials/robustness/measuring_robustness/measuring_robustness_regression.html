

<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Robustness of a Regression Model &#8212; holistic  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom_style.css?v=ac75cb35" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/tutorials/robustness/measuring_robustness/measuring_robustness_regression';</script>
    <link rel="icon" href="../../../../_static/holistic_ai.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/hai_logo.svg" class="logo__image only-light" alt="holistic  documentation - Home"/>
    <img src="https://assets-global.website-files.com/6305e5d42c283515c3e71b8c/63d771efd50a073bd66193f0_Holistic-AI-Logo-Horizontal-Dark.svg" class="logo__image only-dark pst-js-only" alt="holistic  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../index.html">
    Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../changelog/index.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/holistic_ai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/holistic-ai/holisticai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://join.slack.com/t/holisticaicommunity/shared_invite/zt-2jamouyrn-BrMfeoBZIHT8HbLzB3P9QQ" title="Community" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Community</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Robustness of a Regression Model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Robustness-of-a-Regression-Model">
<h1>Robustness of a Regression Model<a class="headerlink" href="#Robustness-of-a-Regression-Model" title="Link to this heading">#</a></h1>
<p>In this notebook, we will evaluate the robustness of a regression model on the “US Crimes” dataset, to perform the analysis. We will use the Linear Regression Gradient Descent Based poisoner to poison the dataset and evaluate the robustness of the model to the poison data. We will use the Mean Squared Error (MSE) as the evaluation metric.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">holistic.datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">holistic.robustness.attackers</span> <span class="kn">import</span> <span class="n">LinRegGDPoisoner</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<section id="Loading-the-dataset">
<h2>Loading the dataset<a class="headerlink" href="#Loading-the-dataset" title="Link to this heading">#</a></h2>
<p>We will use the “US Crimes” dataset, which contains crime statistics for each US state. The target variable is the number of crimes per 100,000 people, and the features are the different crime statistics.</p>
<p>We will use the preprocessed version of the dataset, which is available in the <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> module of the <code class="docutils literal notranslate"><span class="pre">holisticai</span></code> library.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;us_crime&#39;</span><span class="p">,</span> <span class="n">preprocessed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_test</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;holisticai.datasets._dataset.Dataset at 0x7d728860a560&gt;,
 &lt;holisticai.datasets._dataset.Dataset at 0x7d7235939750&gt;)
</pre></div></div>
</div>
</section>
<section id="Preprocessing-the-data">
<h2>Preprocessing the data<a class="headerlink" href="#Preprocessing-the-data" title="Link to this heading">#</a></h2>
<p>Since the ‘fold’ column is used for stratified cross-validation, we will remove it from the input features of the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">])</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>agePct16t24</th>
      <th>agePct65up</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>LemasPctOfficDrugUn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25</td>
      <td>0.00</td>
      <td>0.42</td>
      <td>0.04</td>
      <td>0.13</td>
      <td>0.03</td>
      <td>0.25</td>
      <td>0.42</td>
      <td>0.23</td>
      <td>0.30</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.20</td>
      <td>0.69</td>
      <td>0.60</td>
      <td>0.72</td>
      <td>0.70</td>
      <td>0.03</td>
      <td>0.08</td>
      <td>0.18</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>42</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.04</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.37</td>
      <td>0.39</td>
      <td>0.26</td>
      <td>0.36</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.07</td>
      <td>0.91</td>
      <td>0.85</td>
      <td>0.88</td>
      <td>0.86</td>
      <td>0.04</td>
      <td>0.06</td>
      <td>0.02</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>0.00</td>
      <td>0.67</td>
      <td>0.03</td>
      <td>0.40</td>
      <td>0.03</td>
      <td>0.35</td>
      <td>0.33</td>
      <td>0.23</td>
      <td>0.40</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.31</td>
      <td>0.53</td>
      <td>0.77</td>
      <td>0.64</td>
      <td>0.69</td>
      <td>0.02</td>
      <td>0.16</td>
      <td>0.54</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>0.01</td>
      <td>0.41</td>
      <td>0.01</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.29</td>
      <td>0.33</td>
      <td>0.22</td>
      <td>0.60</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.24</td>
      <td>0.77</td>
      <td>0.78</td>
      <td>0.80</td>
      <td>0.78</td>
      <td>0.01</td>
      <td>0.37</td>
      <td>0.54</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>0.05</td>
      <td>0.51</td>
      <td>0.08</td>
      <td>0.47</td>
      <td>0.47</td>
      <td>0.41</td>
      <td>0.53</td>
      <td>0.34</td>
      <td>0.33</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.47</td>
      <td>0.52</td>
      <td>0.49</td>
      <td>0.85</td>
      <td>0.78</td>
      <td>0.02</td>
      <td>0.52</td>
      <td>0.16</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div></div>
</div>
</section>
<section id="Training-the-regression-model">
<h2>Training the regression model<a class="headerlink" href="#Training-the-regression-model" title="Link to this heading">#</a></h2>
<p>We will train a linear regression model on the training data to use as a baseline model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">baseline_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Baseline error: </span><span class="si">{</span><span class="n">baseline_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Baseline error: 0.018695360634785115
</pre></div></div>
</div>
</section>
<section id="Gradient-Descent-Based-Poisoning">
<h2>Gradient Descent Based Poisoning<a class="headerlink" href="#Gradient-Descent-Based-Poisoning" title="Link to this heading">#</a></h2>
<section id="Linear-based-Poisoning">
<h3>Linear-based Poisoning<a class="headerlink" href="#Linear-based-Poisoning" title="Link to this heading">#</a></h3>
<p>We will now generate poison data using the Linear Regression Gradient Descent Based poisoner. This poisoner uses the training data and the gradient descent algorithm with a linear regressor at its core to generate poison data and then, we will use the poison data to evaluate the robustness of the model and how it affects the model’s performance. A recommended practice is to use a small fraction (no more than 0.2) of the training data to generate the poison data that will be appended to the
training data at the end.</p>
<p>To do that, first, we will create a categorical mask to tell the poisoner which features will be treated as categorical (for our case the <code class="docutils literal notranslate"><span class="pre">state</span></code> feature). Then, we will create the poisoner object and use the <code class="docutils literal notranslate"><span class="pre">generate</span></code> method to generate the poison data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">categorical_mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poiser</span> <span class="o">=</span> <span class="n">LinRegGDPoisoner</span><span class="p">(</span><span class="n">poison_proportion</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#</span>

<span class="c1"># Poison the training data</span>
<span class="n">x_poised</span><span class="p">,</span> <span class="n">y_poised</span> <span class="o">=</span> <span class="n">poiser</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                      <span class="n">categorical_mask</span> <span class="o">=</span> <span class="n">categorical_mask</span><span class="p">,</span>
                                      <span class="n">return_only_poisoned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2024-10-03 10:15:44,934 - INFO - Training Error: 0.044647
2024-10-03 10:15:44,937 - INFO - Best initialization error: 0.044647
2024-10-03 10:15:44,938 - INFO - Poison Count: 374.000000
2024-10-03 10:15:45,045 - INFO - Iteration 0:
2024-10-03 10:15:45,047 - INFO - Objective Value: 0.04464659130536795 Change: 0.04464659130536795
2024-10-03 10:16:32,419 - INFO - Iteration 1:
2024-10-03 10:16:32,422 - INFO - Objective Value: 0.04472660434882227 Change: 8.001304345432031e-05
2024-10-03 10:16:32,424 - INFO - Y pushed out of bounds: 361/374
2024-10-03 10:17:23,469 - INFO - Iteration 2:
2024-10-03 10:17:23,471 - INFO - Objective Value: 0.0452637976663006 Change: 0.0005371933174783267
2024-10-03 10:17:23,472 - INFO - Y pushed out of bounds: 361/374
2024-10-03 10:18:14,753 - INFO - Iteration 3:
2024-10-03 10:18:14,758 - INFO - Objective Value: 0.048907387030308606 Change: 0.003643589364008007
2024-10-03 10:18:14,761 - INFO - Y pushed out of bounds: 360/374
2024-10-03 10:18:59,858 - INFO - Iteration 4:
2024-10-03 10:18:59,860 - INFO - Objective Value: 0.045671181672273416 Change: -0.0032362053580351907
2024-10-03 10:18:59,864 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:18:59,869 - INFO - no progress
2024-10-03 10:19:42,553 - INFO - Iteration 5:
2024-10-03 10:19:42,555 - INFO - Objective Value: 0.04724604045154373 Change: -0.0016613465787648773
2024-10-03 10:19:42,557 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:19:42,559 - INFO - no progress
2024-10-03 10:20:28,414 - INFO - Iteration 6:
2024-10-03 10:20:28,415 - INFO - Objective Value: 0.048036809604417655 Change: -0.0008705774258909518
2024-10-03 10:20:28,419 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:20:28,420 - INFO - no progress
2024-10-03 10:21:16,068 - INFO - Iteration 7:
2024-10-03 10:21:16,071 - INFO - Objective Value: 0.048459453456424315 Change: -0.00044793357388429184
2024-10-03 10:21:16,075 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:21:16,078 - INFO - no progress
2024-10-03 10:22:10,133 - INFO - Iteration 8:
2024-10-03 10:22:10,136 - INFO - Objective Value: 0.04872747172384238 Change: -0.00017991530646622317
2024-10-03 10:22:10,137 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:22:10,139 - INFO - no progress
2024-10-03 10:22:56,946 - INFO - Iteration 9:
2024-10-03 10:22:56,948 - INFO - Objective Value: 0.048839050806797846 Change: -6.833622351076069e-05
2024-10-03 10:22:56,949 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:22:56,952 - INFO - no progress
2024-10-03 10:23:41,160 - INFO - Iteration 10:
2024-10-03 10:23:41,162 - INFO - Objective Value: 0.04890574377605097 Change: -1.643254257638338e-06
2024-10-03 10:23:41,163 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:23:41,164 - INFO - no progress
2024-10-03 10:24:31,314 - INFO - Iteration 11:
2024-10-03 10:24:31,322 - INFO - Objective Value: 0.048932947647614015 Change: 2.556061730540904e-05
2024-10-03 10:24:31,327 - INFO - Y pushed out of bounds: 346/374
2024-10-03 10:25:18,332 - INFO - Iteration 12:
2024-10-03 10:25:18,334 - INFO - Objective Value: 0.048932727842306324 Change: -2.198053076912787e-07
2024-10-03 10:25:18,336 - INFO - Y pushed out of bounds: 349/374
2024-10-03 10:25:18,339 - INFO - no progress
2024-10-03 10:25:58,288 - INFO - Iteration 13:
2024-10-03 10:25:58,290 - INFO - Objective Value: 0.04894340361504006 Change: 1.0455967426041546e-05
2024-10-03 10:25:58,291 - INFO - Y pushed out of bounds: 349/374
2024-10-03 10:26:35,897 - INFO - Iteration 14:
2024-10-03 10:26:35,900 - INFO - Objective Value: 0.0489625103385672 Change: 1.910672352714582e-05
2024-10-03 10:26:35,901 - INFO - Y pushed out of bounds: 351/374
2024-10-03 10:27:15,949 - INFO - Iteration 15:
2024-10-03 10:27:15,951 - INFO - Objective Value: 0.04897222734181617 Change: 9.717003248969902e-06
2024-10-03 10:27:15,955 - INFO - Y pushed out of bounds: 352/374
</pre></div></div>
</div>
<p><strong>Evaluating Model Robustness</strong></p>
<p>We will evaluate the robustness of the model by training the model on the poisoned data and evaluating its performance on the test data. To do that we will concatenate the poisoned samples with the training data, train a model and then compare the performance of the model on the test data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clfp</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">poisedx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_train</span><span class="p">,</span> <span class="n">x_poised</span><span class="p">),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">poisedy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_poised</span><span class="p">])</span>

<span class="n">clfp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">poisedx</span><span class="p">,</span> <span class="n">poisedy</span><span class="p">)</span>

<span class="n">poised_err</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">clfp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error before poisoning:&quot;</span><span class="p">,</span> <span class="n">baseline_error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error after poisoning (Linear):&quot;</span><span class="p">,</span> <span class="n">poised_err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error before poisoning: 0.018695360634785115
Error after poisoning (Linear): 0.019366176179256695
</pre></div></div>
</div>
<p>As we can see from the results, the model’s performance on the test data is slightly worse when trained on the poisoned data. This demonstrates the importance of evaluating the robustness of a model to poison data.</p>
</section>
<section id="Ridge-based-Poisoning">
<h3>Ridge-based Poisoning<a class="headerlink" href="#Ridge-based-Poisoning" title="Link to this heading">#</a></h3>
<p>We will now generate poison data using the same Regression Gradient Descent Based poisoner but with a Ridge regressor at its core. Similarly, we will evaluate the robustness of the model by training the model on the poisoned data and evaluating its performance on the test data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">holistic.robustness.attackers</span> <span class="kn">import</span> <span class="n">RidgeGDPoisoner</span>

<span class="n">poiser</span> <span class="o">=</span> <span class="n">RidgeGDPoisoner</span><span class="p">(</span><span class="n">poison_proportion</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_inits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#</span>

<span class="c1"># Poison the training data</span>
<span class="n">x_poised</span><span class="p">,</span> <span class="n">y_poised</span> <span class="o">=</span> <span class="n">poiser</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                      <span class="n">categorical_mask</span> <span class="o">=</span> <span class="n">categorical_mask</span><span class="p">,</span>
                                      <span class="n">return_only_poisoned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2024-10-03 10:27:16,775 - INFO - Training Error: 0.042605
2024-10-03 10:27:16,778 - INFO - Best initialization error: 0.042605
2024-10-03 10:27:16,788 - INFO - Poison Count: 374.000000
2024-10-03 10:27:16,896 - INFO - Iteration 0:
2024-10-03 10:27:16,902 - INFO - Objective Value: 0.15132651830050933 Change: 0.15132651830050933
2024-10-03 10:28:18,228 - INFO - Iteration 1:
2024-10-03 10:28:18,231 - INFO - Objective Value: 0.47055352441836296 Change: 0.3192270061178536
2024-10-03 10:28:18,235 - INFO - Y pushed out of bounds: 330/374
2024-10-03 10:29:29,596 - INFO - Iteration 2:
2024-10-03 10:29:29,598 - INFO - Objective Value: 0.7847624381404186 Change: 0.3142089137220556
2024-10-03 10:29:29,600 - INFO - Y pushed out of bounds: 329/374
2024-10-03 10:30:31,277 - INFO - Iteration 3:
2024-10-03 10:30:31,278 - INFO - Objective Value: 0.8602627436585353 Change: 0.0755003055181167
2024-10-03 10:30:31,279 - INFO - Y pushed out of bounds: 333/374
2024-10-03 10:31:34,036 - INFO - Iteration 4:
2024-10-03 10:31:34,045 - INFO - Objective Value: 0.8697050512276823 Change: 0.00944230756914699
2024-10-03 10:31:34,047 - INFO - Y pushed out of bounds: 344/374
2024-10-03 10:32:31,613 - INFO - Iteration 5:
2024-10-03 10:32:31,614 - INFO - Objective Value: 0.8703969136725916 Change: 0.0006918624449093747
2024-10-03 10:32:31,616 - INFO - Y pushed out of bounds: 350/374
2024-10-03 10:33:27,809 - INFO - Iteration 6:
2024-10-03 10:33:27,810 - INFO - Objective Value: 0.870370690664801 Change: -2.62230077906489e-05
2024-10-03 10:33:27,814 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:33:27,818 - INFO - no progress
2024-10-03 10:34:39,994 - INFO - Iteration 7:
2024-10-03 10:34:39,999 - INFO - Objective Value: 0.8703993455656631 Change: 2.4318930714750664e-06
2024-10-03 10:34:40,003 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:35:55,692 - INFO - Iteration 8:
2024-10-03 10:35:55,697 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:35:55,700 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:37:14,118 - INFO - Iteration 9:
2024-10-03 10:37:14,121 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:37:14,122 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:38:33,745 - INFO - Iteration 10:
2024-10-03 10:38:33,750 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:38:33,757 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:40:15,981 - INFO - Iteration 11:
2024-10-03 10:40:15,987 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:40:15,993 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:41:53,785 - INFO - Iteration 12:
2024-10-03 10:41:53,788 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:41:53,790 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:43:34,063 - INFO - Iteration 13:
2024-10-03 10:43:34,067 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:43:34,071 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:45:11,278 - INFO - Iteration 14:
2024-10-03 10:45:11,285 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:45:11,298 - INFO - Y pushed out of bounds: 352/374
2024-10-03 10:46:39,430 - INFO - Iteration 15:
2024-10-03 10:46:39,433 - INFO - Objective Value: 0.8703993455656631 Change: 0.0
2024-10-03 10:46:39,439 - INFO - Y pushed out of bounds: 352/374
</pre></div></div>
</div>
<p>Finally, we will compare the performance of the model trained on the poison data generated by the Ridge poisoner.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clfp</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">poisedx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_train</span><span class="p">,</span> <span class="n">x_poised</span><span class="p">),</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">poisedy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_poised</span><span class="p">])</span>

<span class="n">clfp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">poisedx</span><span class="p">,</span> <span class="n">poisedy</span><span class="p">)</span>

<span class="n">poised_ridge_err</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">clfp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error before poisoning:&quot;</span><span class="p">,</span> <span class="n">baseline_error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error after poisoning (Ridge):&quot;</span><span class="p">,</span> <span class="n">poised_ridge_err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error before poisoning: 0.018695360634785115
Error after poisoning (Ridge): 0.01986438344146899
</pre></div></div>
</div>
<p>As we can see from the results, similar to the Linear-based poisoning, the model’s performance on the test data is slightly worse when trained on the poisoned data.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Holistic AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>